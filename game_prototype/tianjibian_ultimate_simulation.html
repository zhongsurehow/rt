<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Â§©Êú∫Âèò - ÂêéÂ§©ÂÖ´Âç¶</title>
    <style>
        body {
            margin: 0;
            padding: 20px;
            font-family: 'Arial', sans-serif;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 219, 255, 0.2) 0%, transparent 50%),
                linear-gradient(135deg, #667eea 0%, #764ba2 50%, #f093fb 100%);
            min-height: 100vh;
            position: relative;
            overflow-x: hidden;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grain" width="100" height="100" patternUnits="userSpaceOnUse"><circle cx="25" cy="25" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="75" cy="75" r="1" fill="rgba(255,255,255,0.1)"/><circle cx="50" cy="10" r="0.5" fill="rgba(255,255,255,0.05)"/><circle cx="20" cy="80" r="0.5" fill="rgba(255,255,255,0.05)"/></pattern></defs><rect width="100" height="100" fill="url(%23grain)"/></svg>');
            pointer-events: none;
            z-index: -1;
        }

        .game-container {
            display: grid;
            grid-template-columns: 280px 1fr 280px;
            grid-template-rows: auto 1fr auto;
            grid-template-areas: 
                "left-panel center right-panel"
                "left-panel center right-panel"
                "controls controls controls";
            width: 100%;
            height: 100vh;
            background: 
                linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.9) 100%);
            color: #2c3e50;
            padding: 0;
            gap: 15px;
            position: relative;
        }

        .game-container::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                radial-gradient(circle at 25% 25%, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(236, 72, 153, 0.1) 0%, transparent 50%);
            pointer-events: none;
            z-index: 0;
        }

        .left-panel {
            grid-area: left-panel;
            background: 
                linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 252, 0.8) 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 15px;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 8px 16px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 1;
        }

        .left-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.05), rgba(236, 72, 153, 0.05));
            z-index: -1;
        }

        .right-panel {
            grid-area: right-panel;
            background: 
                linear-gradient(135deg, rgba(255, 255, 255, 0.9) 0%, rgba(248, 250, 252, 0.8) 100%);
            border-radius: 20px;
            padding: 25px;
            margin: 15px;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 8px 16px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 1;
        }

        .right-panel::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(236, 72, 153, 0.05), rgba(99, 102, 241, 0.05));
            z-index: -1;
        }

        .center-area {
            grid-area: center;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            position: relative;
            margin: 10px;
        }

        .bagua-container {
            position: relative;
            width: 540px;
            height: 540px;
            margin: 20px auto;
        }

        .bagua-map {
            width: 100%;
            height: 100%;
            position: relative;
            border-radius: 20px;
            background: 
                linear-gradient(135deg, rgba(245, 245, 220, 0.95) 0%, rgba(222, 184, 135, 0.95) 50%, rgba(210, 180, 140, 0.95) 100%),
                radial-gradient(circle at 25% 25%, rgba(255, 255, 255, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 75% 75%, rgba(139, 69, 19, 0.1) 0%, transparent 50%);
            box-shadow: 
                0 15px 45px rgba(0, 0, 0, 0.2),
                0 8px 25px rgba(0, 0, 0, 0.15),
                inset 0 2px 4px rgba(255, 255, 255, 0.6),
                inset 0 -2px 4px rgba(139, 69, 19, 0.2);
            border: 4px solid rgba(139, 69, 19, 0.8);
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            grid-template-rows: repeat(3, 1fr);
            gap: 12px;
            padding: 24px;
            backdrop-filter: blur(2px);
        }

        .bagua-position {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.4s ease;
            border: 3px solid rgba(255, 255, 255, 0.9);
            color: white;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            box-shadow: 
                0 6px 12px rgba(0, 0, 0, 0.3),
                inset 0 2px 4px rgba(255, 255, 255, 0.3);
            z-index: 3;
            backdrop-filter: blur(5px);
        }

        .bagua-position::before {
            content: attr(data-symbol);
            font-size: 20px;
            font-weight: 900;
            margin-bottom: 2px;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.8);
        }

        /* ÂÖ´Âç¶‰ΩçÁΩÆËÉåÊôØÈ¢úËâ≤ - ‰ºòÂåñÁâàÊú¨ */
        .bagua-position[data-position="0"] { 
            background: linear-gradient(135deg, rgba(255, 107, 107, 0.85), rgba(255, 82, 82, 0.85)); 
            border: 2px solid rgba(255, 107, 107, 0.4);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.2);
        } /* Á¶ª-Âçó */
        .bagua-position[data-position="1"] { 
            background: linear-gradient(135deg, rgba(254, 202, 87, 0.85), rgba(255, 179, 0, 0.85)); 
            border: 2px solid rgba(254, 202, 87, 0.4);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.2);
        } /* Âù§-Ë•øÂçó */
        .bagua-position[data-position="2"] { 
            background: linear-gradient(135deg, rgba(72, 219, 251, 0.85), rgba(41, 182, 246, 0.85)); 
            border: 2px solid rgba(72, 219, 251, 0.4);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.2);
        } /* ÂÖë-Ë•ø */
        .bagua-position[data-position="3"] { 
            background: linear-gradient(135deg, rgba(255, 215, 0, 0.85), rgba(255, 193, 7, 0.85)); 
            border: 2px solid rgba(255, 215, 0, 0.4);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.2);
        } /* ‰πæ-Ë•øÂåó */
        .bagua-position[data-position="4"] { 
            background: linear-gradient(135deg, rgba(55, 66, 250, 0.85), rgba(63, 81, 181, 0.85)); 
            border: 2px solid rgba(55, 66, 250, 0.4);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.2);
        } /* Âùé-Âåó */
        .bagua-position[data-position="5"] { 
            background: linear-gradient(135deg, rgba(139, 69, 19, 0.85), rgba(121, 85, 72, 0.85)); 
            border: 2px solid rgba(139, 69, 19, 0.4);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.2);
        } /* ËâÆ-‰∏úÂåó */
        .bagua-position[data-position="6"] { 
            background: linear-gradient(135deg, rgba(0, 210, 211, 0.85), rgba(0, 188, 212, 0.85)); 
            border: 2px solid rgba(0, 210, 211, 0.4);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.2);
        } /* Èúá-‰∏ú */
        .bagua-position[data-position="7"] { 
            background: linear-gradient(135deg, rgba(123, 237, 159, 0.85), rgba(76, 175, 80, 0.85)); 
            border: 2px solid rgba(123, 237, 159, 0.4);
            box-shadow: inset 0 2px 4px rgba(255, 255, 255, 0.2);
        } /* Â∑Ω-‰∏úÂçó */

        .bagua-position::after {
            content: attr(data-direction);
            font-size: 9px;
            opacity: 0.95;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.8);
        }

        .bagua-position:hover {
            transform: scale(1.15);
            box-shadow: 
                0 8px 16px rgba(0, 0, 0, 0.4),
                0 0 25px rgba(255, 255, 255, 0.6),
                inset 0 2px 4px rgba(255, 255, 255, 0.4);
            border-color: rgba(255, 255, 255, 1);
            z-index: 4;
        }



        .center-taiji {
            position: relative;
            width: 100%;
            height: 100%;
            border-radius: 15px;
            background: 
                radial-gradient(circle at center, rgba(255, 255, 255, 0.95) 30%, rgba(240, 240, 240, 0.95) 70%),
                linear-gradient(45deg, rgba(212, 175, 55, 0.1) 25%, transparent 25%),
                linear-gradient(-45deg, rgba(212, 175, 55, 0.1) 25%, transparent 25%);
            cursor: pointer;
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 12px 24px rgba(0, 0, 0, 0.2),
                0 6px 12px rgba(0, 0, 0, 0.15),
                inset 0 2px 4px rgba(255, 255, 255, 0.9),
                inset 0 -2px 4px rgba(0, 0, 0, 0.1),
                0 0 20px rgba(212, 175, 55, 0.3);
            border: 4px solid #d4af37;
            overflow: hidden;
            grid-column: 2;
            grid-row: 2;
            backdrop-filter: blur(1px);
        }

        .center-taiji::before {
            content: '';
            position: absolute;
            top: 8%;
            left: 8%;
            width: 84%;
            height: 84%;
            background: 
                radial-gradient(circle at 50% 25%, rgba(255, 255, 255, 0.95) 23%, transparent 25%),
                radial-gradient(circle at 50% 75%, rgba(0, 0, 0, 0.95) 23%, transparent 25%),
                linear-gradient(90deg, rgba(0, 0, 0, 0.9) 50%, rgba(255, 255, 255, 0.9) 50%);
            border-radius: 50%;
            box-shadow: 
                inset 0 2px 8px rgba(0, 0, 0, 0.3),
                inset 0 -2px 8px rgba(255, 255, 255, 0.3),
                0 0 15px rgba(0, 0, 0, 0.2);
            animation: taijRotate 20s linear infinite;
        }

        @keyframes taijRotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }

        /* Êñπ‰ΩçÊ†áÁ≠æ */
        .direction-labels {
            position: absolute;
            top: -30px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 14px;
            font-weight: bold;
            color: #8B4513;
            text-shadow: 1px 1px 2px rgba(255, 255, 255, 0.8);
        }

        .bagua-container::before {
            content: 'Âçó';
            position: absolute;
            top: -35px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 18px;
            font-weight: 900;
            color: #d63031;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9), 0 0 8px rgba(214, 48, 49, 0.6);
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 8px;
            border: 2px solid #d63031;
        }

        .bagua-container::after {
            content: 'Âåó';
            position: absolute;
            bottom: -35px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 18px;
            font-weight: 900;
            color: #0984e3;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9), 0 0 8px rgba(9, 132, 227, 0.6);
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 8px;
            border: 2px solid #0984e3;
        }

        .direction-label-west {
            position: absolute;
            left: -35px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            font-weight: 900;
            color: #fdcb6e;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.7), 0 0 8px rgba(253, 203, 110, 0.6);
            background: rgba(0, 0, 0, 0.8);
            padding: 4px 8px;
            border-radius: 8px;
            border: 2px solid #fdcb6e;
        }

        .direction-label-east {
            position: absolute;
            right: -35px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 18px;
            font-weight: 900;
            color: #00b894;
            text-shadow: 2px 2px 4px rgba(255, 255, 255, 0.9), 0 0 8px rgba(0, 184, 148, 0.6);
            background: rgba(255, 255, 255, 0.9);
            padding: 4px 8px;
            border-radius: 8px;
            border: 2px solid #00b894;
        }

        .center-taiji::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 70px;
            height: 140px;
            background: 
                radial-gradient(circle at 50% 25%, #000 17.5%, transparent 17.5%),
                radial-gradient(circle at 50% 75%, #fff 17.5%, transparent 17.5%),
                linear-gradient(180deg, #fff 50%, #000 50%);
            border-radius: 35px;
        }

        .center-taiji:hover {
            transform: translate(-50%, -50%) scale(1.15) rotate(360deg);
            box-shadow: 
                0 0 50px rgba(212, 175, 55, 0.6),
                inset 0 0 30px rgba(0, 0, 0, 0.2);
        }

        .player-piece {
            position: absolute;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            border: 3px solid #fff;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            color: #fff;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.7);
            animation: playerPulse 2s infinite;
            z-index: 15;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        @keyframes playerPulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 10px rgba(255, 255, 255, 0.5); }
            50% { transform: scale(1.1); box-shadow: 0 0 20px rgba(255, 255, 255, 0.8); }
        }

        .player-piece.player1 { background: #e74c3c; }
        .player-piece.player2 { background: #3498db; }
        .player-piece.player3 { background: #2ecc71; }
        .player-piece.player4 { background: #f39c12; }

        .status-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 15px;
            color: #2c3e50;
            text-align: center;
            border-bottom: 2px solid #3498db;
            padding-bottom: 10px;
        }

        .attribute {
            display: flex;
            justify-content: space-between;
            margin: 8px 0;
            padding: 8px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 8px;
            transition: all 0.3s ease;
        }

        .attribute:hover {
            background: rgba(255, 255, 255, 0.9);
            transform: translateX(5px);
        }

        .attribute.highlight {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            animation: attributeGlow 1s ease-in-out;
        }

        @keyframes attributeGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(255, 215, 0, 0.5); }
            50% { box-shadow: 0 0 20px rgba(255, 215, 0, 0.8); }
        }

        .controls {
            grid-area: controls;
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            padding: 25px;
            background: 
                linear-gradient(135deg, rgba(255, 255, 255, 0.95) 0%, rgba(248, 250, 252, 0.9) 100%);
            border-radius: 20px;
            margin: 15px;
            box-shadow: 
                0 20px 40px rgba(0, 0, 0, 0.1),
                0 8px 16px rgba(0, 0, 0, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.3);
            position: relative;
            z-index: 1;
        }

        .controls::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            border-radius: 20px;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.03), rgba(236, 72, 153, 0.03));
            z-index: -1;
        }

        .btn {
            padding: 14px 28px;
            border: none;
            border-radius: 30px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 8px 25px rgba(0, 0, 0, 0.15),
                0 4px 10px rgba(0, 0, 0, 0.1);
            position: relative;
            overflow: hidden;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            transition: left 0.6s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px) scale(1.05);
            box-shadow: 
                0 15px 35px rgba(0, 0, 0, 0.2),
                0 8px 15px rgba(0, 0, 0, 0.15);
        }

        .btn:active {
            transform: translateY(-1px) scale(1.02);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 
                0 8px 25px rgba(102, 126, 234, 0.4),
                0 4px 10px rgba(118, 75, 162, 0.3);
        }

        .btn-primary:hover {
            box-shadow: 
                0 15px 35px rgba(102, 126, 234, 0.5),
                0 8px 15px rgba(118, 75, 162, 0.4);
        }

        .btn-success {
            background: linear-gradient(135deg, #56ab2f 0%, #a8e6cf 100%);
            color: white;
            box-shadow: 
                0 8px 25px rgba(86, 171, 47, 0.4),
                0 4px 10px rgba(168, 230, 207, 0.3);
        }

        .btn-success:hover {
            box-shadow: 
                0 15px 35px rgba(86, 171, 47, 0.5),
                0 8px 15px rgba(168, 230, 207, 0.4);
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
            box-shadow: 
                0 8px 25px rgba(240, 147, 251, 0.4),
                0 4px 10px rgba(245, 87, 108, 0.3);
        }

        .btn-warning:hover {
            box-shadow: 
                0 15px 35px rgba(240, 147, 251, 0.5),
                0 8px 15px rgba(245, 87, 108, 0.4);
        }

        .btn-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            box-shadow: 
                0 8px 25px rgba(79, 172, 254, 0.4),
                0 4px 10px rgba(0, 242, 254, 0.3);
        }

        .btn-info:hover {
            box-shadow: 
                0 15px 35px rgba(79, 172, 254, 0.5),
                0 8px 15px rgba(0, 242, 254, 0.4);
        }

        .demo-status {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px;
            border-radius: 10px;
            font-size: 14px;
            z-index: 1000;
            display: none;
        }

        .demo-status.active {
            display: block;
            animation: slideIn 0.5s ease-out;
        }

        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .turn-info {
            text-align: center;
            margin: 20px 0;
            font-size: 16px;
            font-weight: bold;
            color: #2c3e50;
        }

        .cards-container {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .card {
            position: relative;
            background: linear-gradient(135deg, 
                rgba(255, 255, 255, 0.95) 0%, 
                rgba(248, 250, 252, 0.9) 50%, 
                rgba(241, 245, 249, 0.85) 100%);
            border: 2px solid transparent;
            border-radius: 15px;
            padding: 15px;
            margin: 5px 0;
            cursor: pointer;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 
                0 4px 20px rgba(0, 0, 0, 0.08),
                0 2px 8px rgba(0, 0, 0, 0.04),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            backdrop-filter: blur(10px);
            overflow: hidden;
        }

        .card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, 
                rgba(99, 102, 241, 0.05) 0%, 
                rgba(236, 72, 153, 0.05) 50%, 
                rgba(251, 191, 36, 0.05) 100%);
            border-radius: 15px;
            z-index: -1;
            transition: opacity 0.3s ease;
            opacity: 0;
        }

        .card::after {
            content: attr(data-element);
            position: absolute;
            top: 8px;
            right: 12px;
            font-size: 20px;
            opacity: 0.6;
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-3px) scale(1.02);
            box-shadow: 
                0 12px 40px rgba(0, 0, 0, 0.15),
                0 6px 20px rgba(0, 0, 0, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
            border-color: rgba(99, 102, 241, 0.4);
        }

        .card:hover::before {
            opacity: 1;
        }

        .card:hover::after {
            transform: scale(1.2) rotate(5deg);
            opacity: 0.8;
        }

        .card.selected {
            border-color: rgba(34, 197, 94, 0.6);
            background: linear-gradient(135deg, 
                rgba(220, 252, 231, 0.95) 0%, 
                rgba(187, 247, 208, 0.9) 50%, 
                rgba(134, 239, 172, 0.85) 100%);
            transform: translateY(-2px) scale(1.01);
            box-shadow: 
                0 8px 30px rgba(34, 197, 94, 0.2),
                0 4px 15px rgba(34, 197, 94, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.8);
        }

        .card.selected::before {
            background: linear-gradient(135deg, 
                rgba(34, 197, 94, 0.1) 0%, 
                rgba(16, 185, 129, 0.08) 100%);
            opacity: 1;
        }

        .card-name {
            font-weight: 700;
            font-size: 16px;
            color: #1e293b;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-name::before {
            content: 'üé¥';
            font-size: 18px;
            animation: cardPulse 2s ease-in-out infinite;
        }

        .card-description {
            font-size: 13px;
            color: #64748b;
            line-height: 1.4;
            margin-bottom: 8px;
        }

        .card-cost {
            position: absolute;
            top: 8px;
            left: 12px;
            background: linear-gradient(135deg, #3b82f6, #1d4ed8);
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            font-weight: 700;
            box-shadow: 0 2px 8px rgba(59, 130, 246, 0.3);
        }

        .card-element {
            position: absolute;
            top: 8px;
            right: 12px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 10px;
            font-weight: bold;
        }

        .card-icon {
            font-size: 24px;
            text-align: center;
            margin: 8px 0;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.1));
        }

        .card-effect {
            font-size: 11px;
            color: #64748b;
            margin-top: 8px;
            line-height: 1.3;
            text-align: center;
            font-weight: 500;
        }

        .synergy-indicator {
            position: absolute;
            top: 40px;
            left: 12px;
            font-size: 16px;
            animation: pulse 1.5s infinite;
            filter: drop-shadow(0 2px 4px rgba(0, 0, 0, 0.3));
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.2); opacity: 0.7; }
        }

        /* ÂçèÂêåÊïàÊûúÂç°ÁâåÊ†∑Âºè */
        .card.synergy-perfect {
            box-shadow: 0 0 20px rgba(255, 215, 0, 0.6), 0 8px 32px rgba(0, 0, 0, 0.12);
            border: 2px solid #FFD700;
            transform: translateY(-2px);
        }

        .card.synergy-generate {
            box-shadow: 0 0 20px rgba(144, 238, 144, 0.6), 0 8px 32px rgba(0, 0, 0, 0.12);
            border: 2px solid #90EE90;
            transform: translateY(-2px);
        }

        .card.synergy-support {
            box-shadow: 0 0 20px rgba(135, 206, 235, 0.6), 0 8px 32px rgba(0, 0, 0, 0.12);
            border: 2px solid #87CEEB;
            transform: translateY(-2px);
        }

        /* ËßÜËßâÂèçÈ¶àÊïàÊûú */
        .player-piece.moving {
            animation: playerMove 0.8s ease-in-out;
            z-index: 1000;
        }

        @keyframes playerMove {
            0% { transform: translate(-50%, -50%) scale(1); }
            50% { transform: translate(-50%, -50%) scale(1.2); }
            100% { transform: translate(-50%, -50%) scale(1); }
        }

        .move-trail {
            position: absolute;
            width: 20px;
            height: 20px;
            background: radial-gradient(circle, rgba(74, 144, 226, 0.6), transparent);
            border-radius: 50%;
            pointer-events: none;
            animation: trailFade 0.8s ease-out forwards;
        }

        @keyframes trailFade {
            0% { opacity: 1; transform: scale(1); }
            100% { opacity: 0; transform: scale(2); }
        }

        .current-position {
            animation: positionHighlight 2s ease-in-out infinite;
            box-shadow: 0 0 20px rgba(74, 144, 226, 0.8);
        }

        @keyframes positionHighlight {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(74, 144, 226, 0.4);
                transform: scale(1);
            }
            50% { 
                box-shadow: 0 0 30px rgba(74, 144, 226, 0.8);
                transform: scale(1.05);
            }
        }

        .action-feedback {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 12px 20px;
            border-radius: 25px;
            font-weight: bold;
            font-size: 14px;
            z-index: 10000;
            animation: feedbackSlide 2s ease-out forwards;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }

        @keyframes feedbackSlide {
            0% { 
                transform: translateX(100%);
                opacity: 0;
            }
            10%, 90% { 
                transform: translateX(0);
                opacity: 1;
            }
            100% { 
                transform: translateX(100%);
                opacity: 0;
            }
        }

        @keyframes cardPulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes cardGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(99, 102, 241, 0.3); }
            50% { box-shadow: 0 0 20px rgba(99, 102, 241, 0.6); }
        }

        .card.playable {
            animation: cardGlow 2s ease-in-out infinite;
        }

        /* Á®ÄÊúâÂ∫¶ËæπÊ°ÜÊ†∑Âºè */
        .card.border-common {
            border-color: rgba(156, 163, 175, 0.6);
        }

        .card.border-rare {
            border-color: rgba(59, 130, 246, 0.6);
            box-shadow: 
                0 4px 20px rgba(59, 130, 246, 0.1),
                0 2px 8px rgba(59, 130, 246, 0.05),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }

        .card.border-epic {
            border-color: rgba(147, 51, 234, 0.6);
            box-shadow: 
                0 4px 20px rgba(147, 51, 234, 0.15),
                0 2px 8px rgba(147, 51, 234, 0.08),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
        }

        .card.border-legendary {
            border-color: rgba(251, 191, 36, 0.8);
            box-shadow: 
                0 4px 20px rgba(251, 191, 36, 0.2),
                0 2px 8px rgba(251, 191, 36, 0.1),
                inset 0 1px 0 rgba(255, 255, 255, 0.6);
            background: linear-gradient(135deg, 
                rgba(255, 248, 220, 0.95) 0%, 
                rgba(254, 243, 199, 0.9) 50%, 
                rgba(253, 230, 138, 0.85) 100%);
        }

        .card.border-legendary::before {
            background: linear-gradient(135deg, 
                rgba(251, 191, 36, 0.1) 0%, 
                rgba(245, 158, 11, 0.08) 100%);
            opacity: 1;
        }

        .log-container {
            max-height: 200px;
            overflow-y: auto;
            background: rgba(248, 249, 250, 0.9);
            border-radius: 10px;
            padding: 10px;
            margin-top: 20px;
        }

        .log-entry {
            margin: 5px 0;
            padding: 5px;
            border-radius: 5px;
            font-size: 12px;
        }

        .log-entry.system {
            background: #e3f2fd;
            color: #1976d2;
        }

        .log-entry.player {
            background: #f3e5f5;
            color: #7b1fa2;
        }

        .log-entry.action {
            background: #e8f5e8;
            color: #388e3c;
        }

        .log-entry.synergy {
            background: linear-gradient(45deg, rgba(255, 215, 0, 0.2), rgba(255, 140, 0, 0.2));
            color: #FF8C00;
            font-weight: bold;
            border-left: 3px solid #FFD700;
            padding-left: 8px;
            animation: synergyGlow 1s ease-in-out;
        }

        @keyframes synergyGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(255, 215, 0, 0.3); }
            50% { box-shadow: 0 0 15px rgba(255, 215, 0, 0.6); }
        }

        /* ÂçèÂêåÊïàÊûúÂä®Áîª */
        .bagua-map.synergy-perfect {
            animation: perfectSynergy 2s ease-in-out;
        }

        .bagua-map.synergy-generate {
            animation: generateSynergy 2s ease-in-out;
        }

        .bagua-map.synergy-support {
            animation: supportSynergy 2s ease-in-out;
        }

        @keyframes perfectSynergy {
            0%, 100% { 
                filter: brightness(1) saturate(1);
                transform: scale(1);
            }
            25% { 
                filter: brightness(1.3) saturate(1.5);
                transform: scale(1.02);
            }
            50% { 
                filter: brightness(1.5) saturate(2);
                transform: scale(1.05);
            }
            75% { 
                filter: brightness(1.3) saturate(1.5);
                transform: scale(1.02);
            }
        }

        @keyframes generateSynergy {
            0%, 100% { 
                filter: hue-rotate(0deg) brightness(1);
            }
            50% { 
                filter: hue-rotate(30deg) brightness(1.2);
            }
        }

        @keyframes supportSynergy {
            0%, 100% { 
                box-shadow: 0 0 20px rgba(0, 255, 0, 0);
            }
            50% { 
                box-shadow: 0 0 30px rgba(0, 255, 0, 0.4);
            }
        }

        .ai-players {
            margin-top: 20px;
        }

        .ai-player {
            background: rgba(255, 255, 255, 0.8);
            border-radius: 10px;
            padding: 10px;
            margin: 10px 0;
            border-left: 4px solid #3498db;
        }

        .ai-player.active {
            border-left-color: #e74c3c;
            background: rgba(231, 76, 60, 0.1);
            animation: aiPlayerGlow 1s ease-in-out;
        }

        @keyframes aiPlayerGlow {
            0%, 100% { box-shadow: 0 0 5px rgba(231, 76, 60, 0.3); }
            50% { box-shadow: 0 0 15px rgba(231, 76, 60, 0.6); }
        }

        .ai-player h4 {
            margin: 0 0 10px 0;
            color: #2c3e50;
        }

        .ai-stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 5px;
            font-size: 12px;
        }

        .ai-stat {
            background: rgba(255, 255, 255, 0.7);
            padding: 5px;
            border-radius: 5px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="game-container">
        <div class="left-panel">
            <div class="status-title">Áé©ÂÆ∂Áä∂ÊÄÅ</div>
            <div class="attribute">
                <span>‰ΩçÁΩÆ:</span>
                <span id="playerPosition">‰∏≠Â§Æ</span>
            </div>
            <div class="attribute">
                <span>ÁîüÂëΩ:</span>
                <span id="playerHealth">100</span>
            </div>
            <div class="attribute">
                <span>ËÉΩÈáè:</span>
                <span id="playerEnergy">50</span>
            </div>
            <div class="attribute">
                <span>Èò¥Èò≥:</span>
                <span id="playerBalance">Âπ≥Ë°°</span>
            </div>
            <div class="attribute">
                <span>Ê∞îÂÄº:</span>
                <span id="playerQi">30</span>
            </div>
            <div class="attribute">
                <span>Ë°åÂä®ÁÇπ:</span>
                <span id="playerActions">3</span>
            </div>

            <div class="cards-container">
                <div class="status-title">ÊâãÁâå</div>
                <div id="playerCards" class="cards-container">
                    <div class="card playable" data-element="üèîÔ∏è" onclick="selectCard(0)">
                        <div class="card-cost">2</div>
                        <div class="card-name">‰πæ‰∏∫Â§©</div>
                        <div class="card-description">Â§©Ë°åÂÅ•ÔºåÂêõÂ≠ê‰ª•Ëá™Âº∫‰∏çÊÅØ„ÄÇÂ§ßÂπÖÊèêÂçáÊ∞îÂÄºÂíåÈ¢ÜÂØºÂäõ„ÄÇ</div>
                    </div>
                    <div class="card playable" data-element="üåç" onclick="selectCard(1)">
                        <div class="card-cost">1</div>
                        <div class="card-name">Âù§‰∏∫Âú∞</div>
                        <div class="card-description">Âú∞ÂäøÂù§ÔºåÂêõÂ≠ê‰ª•ÂéöÂæ∑ËΩΩÁâ©„ÄÇÊÅ¢Â§çÁîüÂëΩÂπ∂Â¢ûÂº∫Èò≤Âæ°„ÄÇ</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="center-area">
            <div class="turn-info">
                <div>ÂõûÂêà: <span id="turnCounter">1</span></div>
                <div>ÂΩìÂâçÁé©ÂÆ∂: <span id="currentPlayer">Áé©ÂÆ∂1</span></div>
            </div>

            <div class="bagua-container">
                <div class="direction-label-west">Ë•ø</div>
                <div class="direction-label-east">‰∏ú</div>
                <div class="bagua-map">
                    <!-- Á¨¨‰∏ÄË°åÔºöÂ∑Ω(‰∏úÂçó) Á¶ª(Âçó) Âù§(Ë•øÂçó) -->
                    <div class="bagua-position" data-position="7" data-symbol="‚ò¥" data-direction="‰∏úÂçó" onclick="moveToPosition(7)" title="Â∑ΩÂç¶ - Êú® - ‰∏úÂçóÊñπ">
                        <div>Â∑Ω</div>
                        <div>Êú®</div>
                    </div>
                    <div class="bagua-position" data-position="0" data-symbol="‚ò≤" data-direction="Âçó" onclick="moveToPosition(0)" title="Á¶ªÂç¶ - ÁÅ´ - ÂçóÊñπ">
                        <div>Á¶ª</div>
                        <div>ÁÅ´</div>
                    </div>
                    <div class="bagua-position" data-position="1" data-symbol="‚ò∑" data-direction="Ë•øÂçó" onclick="moveToPosition(1)" title="Âù§Âç¶ - Âúü - Ë•øÂçóÊñπ">
                        <div>Âù§</div>
                        <div>Âúü</div>
                    </div>
                    
                    <!-- Á¨¨‰∫åË°åÔºöÈúá(‰∏ú) ‰∏≠ÂøÉ ÂÖë(Ë•ø) -->
                    <div class="bagua-position" data-position="6" data-symbol="‚ò≥" data-direction="‰∏ú" onclick="moveToPosition(6)" title="ÈúáÂç¶ - Êú® - ‰∏úÊñπ">
                        <div>Èúá</div>
                        <div>Êú®</div>
                    </div>
                    <div class="center-taiji" onclick="moveToCenter()"></div>
                    <div class="bagua-position" data-position="2" data-symbol="‚ò±" data-direction="Ë•ø" onclick="moveToPosition(2)" title="ÂÖëÂç¶ - Èáë - Ë•øÊñπ">
                        <div>ÂÖë</div>
                        <div>Èáë</div>
                    </div>
                    
                    <!-- Á¨¨‰∏âË°åÔºöËâÆ(‰∏úÂåó) Âùé(Âåó) ‰πæ(Ë•øÂåó) -->
                    <div class="bagua-position" data-position="5" data-symbol="‚ò∂" data-direction="‰∏úÂåó" onclick="moveToPosition(5)" title="ËâÆÂç¶ - Âúü - ‰∏úÂåóÊñπ">
                        <div>ËâÆ</div>
                        <div>Âúü</div>
                    </div>
                    <div class="bagua-position" data-position="4" data-symbol="‚òµ" data-direction="Âåó" onclick="moveToPosition(4)" title="ÂùéÂç¶ - Ê∞¥ - ÂåóÊñπ">
                        <div>Âùé</div>
                        <div>Ê∞¥</div>
                    </div>
                    <div class="bagua-position" data-position="3" data-symbol="‚ò∞" data-direction="Ë•øÂåó" onclick="moveToPosition(3)" title="‰πæÂç¶ - Èáë - Ë•øÂåóÊñπ">
                        <div>‰πæ</div>
                        <div>Èáë</div>
                    </div>
                    
                    <div class="player-piece player1" id="player1Piece" style="top: 50%; left: 50%; transform: translate(-50%, -50%);">1</div>
                </div>
            </div>
        </div>

        <div class="right-panel">
            <div class="status-title">AI Áé©ÂÆ∂</div>
            <div class="ai-players" id="aiPlayers">
                <!-- AIÁé©ÂÆ∂Áä∂ÊÄÅÂ∞ÜÂú®ËøôÈáåÂä®ÊÄÅÁîüÊàê -->
            </div>

            <div class="log-container">
                <div class="status-title">Ê∏∏ÊàèÊó•Âøó</div>
                <div id="gameLog">
                    <div class="log-entry system">Ê∏∏ÊàèÂºÄÂßã</div>
                </div>
            </div>
        </div>

        <div class="controls">
            <button class="btn btn-primary" onclick="game.startAutoDemo()" id="demoBtn">ÂºÄÂßãËá™Âä®ÊºîÁ§∫</button>
            <button class="btn btn-success" onclick="game.startFourPlayerDemo()" id="fourPlayerDemoBtn">Âõõ‰∫∫ÊºîÁ§∫</button>
            <button class="btn btn-warning" onclick="game.startAISimulation()" id="aiBtn">AIÊ®°Êãü</button>
            <button class="btn btn-info" onclick="endTurn()">ÁªìÊùüÂõûÂêà</button>
            <button class="btn btn-primary" onclick="clearLog()">Ê∏ÖÁ©∫Êó•Âøó</button>
        </div>
    </div>

    <div class="demo-status" id="demoStatus">
        <div id="demoMessage">ÊºîÁ§∫ËøõË°å‰∏≠...</div>
        <div id="demoStep">Ê≠•È™§: 1/6</div>
    </div>

    <script>
        class Game {
            constructor() {
                this.currentPlayer = 1;
                this.turnCounter = 1;
                this.playerPosition = 'center';
                this.playerStats = {
                    health: 100,
                    energy: 50,
                    balance: 0, // -100Âà∞100ÔºåË¥üÊï∞‰∏∫Èò¥ÔºåÊ≠£Êï∞‰∏∫Èò≥
                    qi: 30,
                    actions: 3
                };
                this.selectedCard = null;
                this.demoMode = false;
                this.demoStep = 0;
                this.demoTimer = null;
                this.aiMode = false;
                this.aiPlayers = [];
                this.fourPlayerMode = false;

                this.baguaData = {
                    0: { name: 'Á¶ª', direction: 'Âçó', element: 'ÁÅ´', symbol: '‚ò≤', effect: 'Â¢ûÂº∫Èò≥Ê∞îÔºåÊèêÂçáÊîªÂáªÂäõ', color: '#ff6b6b' },
                    1: { name: 'Âù§', direction: 'Ë•øÂçó', element: 'Âúü', symbol: '‚ò∑', effect: 'Á®≥ÂÆöÊ∞îÂÄºÔºåÂ¢ûÂº∫Èò≤Âæ°', color: '#feca57' },
                    2: { name: 'ÂÖë', direction: 'Ë•ø', element: 'Èáë', symbol: '‚ò±', effect: 'Âπ≥Ë°°Èò¥Èò≥ÔºåÊÅ¢Â§çËÉΩÈáè', color: '#48dbfb' },
                    3: { name: '‰πæ', direction: 'Ë•øÂåó', element: 'Èáë', symbol: '‚ò∞', effect: 'Â§ßÂπÖÂ¢ûÂº∫Èò≥Ê∞îÂíåÈ¢ÜÂØºÂäõ', color: '#ffd700' },
                    4: { name: 'Âùé', direction: 'Âåó', element: 'Ê∞¥', symbol: '‚òµ', effect: 'Â¢ûÂº∫Èò¥Ê∞îÔºåÊèêÂçáÊô∫ÊÖß', color: '#3742fa' },
                    5: { name: 'ËâÆ', direction: '‰∏úÂåó', element: 'Âúü', symbol: '‚ò∂', effect: 'Á®≥Âõ∫Ê†πÂü∫ÔºåÂ¢ûÂº∫ËÄêÂäõ', color: '#8b4513' },
                    6: { name: 'Èúá', direction: '‰∏ú', element: 'Êú®', symbol: '‚ò≥', effect: 'ÊøÄÂèëÊ¥ªÂäõÔºåÂ¢ûÂº∫Ë°åÂä®Âäõ', color: '#00d2d3' },
                    7: { name: 'Â∑Ω', direction: '‰∏úÂçó', element: 'Êú®', symbol: '‚ò¥', effect: 'ÊüîÂíåË∞ÉËäÇÔºåÂ¢ûÂº∫ÈÄÇÂ∫îÊÄß', color: '#7bed9f' }
                };

                this.cardDatabase = [
                    { 
                        id: 1, name: '‰πæ‰∏∫Â§©', cost: 2, effect: '+20Ê∞îÂÄº', type: 'Â¢ûÁõä', element: 'Èáë',
                        icon: 'üèîÔ∏è', description: 'Â§©Ë°åÂÅ•ÔºåÂêõÂ≠ê‰ª•Ëá™Âº∫‰∏çÊÅØ„ÄÇÂ§ßÂπÖÊèêÂçáÊ∞îÂÄºÂíåÈ¢ÜÂØºÂäõ„ÄÇ',
                        rarity: 'legendary'
                    },
                    { 
                        id: 2, name: 'Âù§‰∏∫Âú∞', cost: 1, effect: '+15ÁîüÂëΩ', type: 'Ê≤ªÁñó', element: 'Âúü',
                        icon: 'üåç', description: 'Âú∞ÂäøÂù§ÔºåÂêõÂ≠ê‰ª•ÂéöÂæ∑ËΩΩÁâ©„ÄÇÊÅ¢Â§çÁîüÂëΩÂπ∂Â¢ûÂº∫Èò≤Âæ°„ÄÇ',
                        rarity: 'common'
                    },
                    { 
                        id: 3, name: 'Èúá‰∏∫Èõ∑', cost: 3, effect: '+25ÊîªÂáªÂäõ', type: 'ÊîªÂáª', element: 'Êú®',
                        icon: '‚ö°', description: 'ÈúáÊÉäÁôæÈáåÔºå‰∏ç‰∏ßÂåïÈ¨Ø„ÄÇÈõ∑ÈúÜ‰∏áÈíßÔºåÊëßÊûØÊãâÊúΩ„ÄÇ',
                        rarity: 'epic'
                    },
                    { 
                        id: 4, name: 'Â∑Ω‰∏∫È£é', cost: 2, effect: '+10ÊïèÊç∑', type: 'Â¢ûÁõä', element: 'Êú®',
                        icon: 'üå™Ô∏è', description: 'Â∑ΩÈ£éÂÖ•ÂæÆÔºåÊó†Â≠î‰∏çÂÖ•„ÄÇÊèêÂçáÊïèÊç∑ÂíåÈÄÇÂ∫îËÉΩÂäõ„ÄÇ',
                        rarity: 'rare'
                    },
                    { 
                        id: 5, name: 'Âùé‰∏∫Ê∞¥', cost: 2, effect: '+Èò¥Ê∞îÂπ≥Ë°°', type: 'Âπ≥Ë°°', element: 'Ê∞¥',
                        icon: 'üåä', description: 'Ê∞¥ÊµÅ‰∏çÊÅØÔºåÊüîËÉΩÂÖãÂàö„ÄÇÂπ≥Ë°°Èò¥Èò≥ÔºåÊô∫ÊÖßÂ¶ÇÊ∞¥„ÄÇ',
                        rarity: 'rare'
                    },
                    { 
                        id: 6, name: 'Á¶ª‰∏∫ÁÅ´', cost: 3, effect: '+Èò≥Ê∞îÊøÄÂèë', type: 'ÊøÄÂèë', element: 'ÁÅ´',
                        icon: 'üî•', description: 'Á¶ªÁÅ´ÈÄöÊòéÔºåÁÖß‰∫ÆÂâçË∑Ø„ÄÇÊøÄÂèëÈò≥Ê∞îÔºåÁáÉÁÉßÊñóÂøó„ÄÇ',
                        rarity: 'epic'
                    },
                    { 
                        id: 7, name: 'ËâÆ‰∏∫Â±±', cost: 1, effect: '+Èò≤Âæ°Âäõ', type: 'Èò≤Âæ°', element: 'Âúü',
                        icon: '‚õ∞Ô∏è', description: 'ËâÆÂ±±Ê≠¢ÈùôÔºåÁ®≥Â¶ÇÊ≥∞Â±±„ÄÇÂ¢ûÂº∫Èò≤Âæ°ÔºåÂõ∫Ëã•ÈáëÊ±§„ÄÇ',
                        rarity: 'common'
                    },
                    { 
                        id: 8, name: 'ÂÖë‰∏∫Ê≥Ω', cost: 2, effect: 'ÊÅ¢Â§çËÉΩÈáè', type: 'ÊÅ¢Â§ç', element: 'Èáë',
                        icon: 'üíß', description: 'ÂÖëÊ≥ΩÊ∂¶Áâ©ÔºåÂíåÊÇ¶Ëá¥Á••„ÄÇÊÅ¢Â§çËÉΩÈáèÔºåÂøÉÂ¢ÉÂπ≥Âíå„ÄÇ',
                        rarity: 'rare'
                    }
                ];

                this.initializeGame();
            }

            initializeGame() {
                this.updateDisplay();
                this.addLogEntry('system', 'Â§©Êú∫ÂèòÊ∏∏ÊàèÂàùÂßãÂåñÂÆåÊàê');
            }

            // Ëá™Âä®ÊºîÁ§∫ÂäüËÉΩ
            startAutoDemo() {
                if (this.demoMode) {
                    this.stopAutoDemo();
                    return;
                }

                this.demoMode = true;
                this.demoStep = 0;
                this.fourPlayerMode = false;
                document.getElementById('demoBtn').textContent = 'ÂÅúÊ≠¢ÊºîÁ§∫';
                document.getElementById('demoStatus').classList.add('active');
                
                this.addLogEntry('system', 'ÂºÄÂßãËá™Âä®ÊºîÁ§∫Ê®°Âºè');
                this.runDemoStep();
            }

            stopAutoDemo() {
                this.demoMode = false;
                this.fourPlayerMode = false;
                if (this.demoTimer) {
                    clearTimeout(this.demoTimer);
                    this.demoTimer = null;
                }
                document.getElementById('demoBtn').textContent = 'ÂºÄÂßãËá™Âä®ÊºîÁ§∫';
                document.getElementById('fourPlayerDemoBtn').textContent = 'Âõõ‰∫∫ÊºîÁ§∫';
                document.getElementById('demoStatus').classList.remove('active');
                this.addLogEntry('system', 'ÊºîÁ§∫Ê®°ÂºèÂ∑≤ÂÅúÊ≠¢');
            }

            runDemoStep() {
                if (!this.demoMode) return;

                const demoSteps = [
                    () => {
                        this.addLogEntry('demo', 'Ê≠•È™§1: ËßÇÂØüÂΩìÂâç‰ΩçÁΩÆÂíåÁä∂ÊÄÅ');
                        this.highlightPlayerStats();
                        document.getElementById('demoMessage').textContent = 'ËßÇÂØüÁé©ÂÆ∂ÂΩìÂâçÁä∂ÊÄÅ';
                    },
                    () => {
                        this.addLogEntry('demo', 'Ê≠•È™§2: Êü•ÁúãÂèØÁî®ÊâãÁâå');
                        this.highlightCards();
                        document.getElementById('demoMessage').textContent = 'Êü•ÁúãÊâãÁâåÈÄâÈ°π';
                    },
                    () => {
                        this.addLogEntry('demo', 'Ê≠•È™§3: ÁßªÂä®Âà∞Á¶ª‰ΩçÔºàÂçóÊñπÁÅ´‰ΩçÔºâ');
                        this.moveToPosition(0);
                        this.highlightPosition(0);
                        document.getElementById('demoMessage').textContent = 'ÁßªÂä®Âà∞Á¶ª‰ΩçÂ¢ûÂº∫Èò≥Ê∞î';
                    },
                    () => {
                        this.addLogEntry('demo', 'Ê≠•È™§4: ‰ΩøÁî®Âç°Áâå"‰πæ‰∏∫Â§©"');
                        this.selectCard(0);
                        this.playSelectedCard();
                        document.getElementById('demoMessage').textContent = '‰ΩøÁî®Âç°ÁâåÂ¢ûÂº∫ËÉΩÂäõ';
                    },
                    () => {
                        this.addLogEntry('demo', 'Ê≠•È™§5: ËßÇÂØüÈò¥Èò≥Âπ≥Ë°°ÂèòÂåñ');
                        this.updateStatsWithAnimation();
                        document.getElementById('demoMessage').textContent = 'ËßÇÂØüÁä∂ÊÄÅÂèòÂåñ';
                    },
                    () => {
                        this.addLogEntry('demo', 'Ê≠•È™§6: ÁªìÊùüÂõûÂêà');
                        this.endTurn();
                        document.getElementById('demoMessage').textContent = 'ÂõûÂêàÁªìÊùüÔºåÂáÜÂ§á‰∏ã‰∏ÄËΩÆ';
                    }
                ];

                if (this.demoStep < demoSteps.length) {
                    demoSteps[this.demoStep]();
                    document.getElementById('demoStep').textContent = `Ê≠•È™§: ${this.demoStep + 1}/${demoSteps.length}`;
                    this.demoStep++;
                    
                    this.demoTimer = setTimeout(() => {
                        this.runDemoStep();
                    }, 3000);
                } else {
                    this.addLogEntry('system', 'Ëá™Âä®ÊºîÁ§∫ÂÆåÊàê');
                    this.stopAutoDemo();
                }
            }

            // Âõõ‰∫∫ÊºîÁ§∫Ê®°Âºè
            startFourPlayerDemo() {
                if (this.fourPlayerMode) {
                    this.stopAutoDemo();
                    return;
                }

                this.fourPlayerMode = true;
                this.demoMode = true;
                this.demoStep = 0;
                document.getElementById('fourPlayerDemoBtn').textContent = 'ÂÅúÊ≠¢Âõõ‰∫∫ÊºîÁ§∫';
                document.getElementById('demoStatus').classList.add('active');
                
                this.initializeFourPlayers();
                this.addLogEntry('system', 'ÂºÄÂßãÂõõ‰∫∫ÊºîÁ§∫Ê®°Âºè');
                this.runFourPlayerDemo();
            }

            initializeFourPlayers() {
                // ÂàõÂª∫Âõõ‰∏™Áé©ÂÆ∂Ê£ãÂ≠ê
                for (let i = 1; i <= 4; i++) {
                    let piece = document.getElementById(`player${i}Piece`);
                    if (!piece) {
                        piece = document.createElement('div');
                        piece.id = `player${i}Piece`;
                        piece.className = `player-piece player${i}`;
                        piece.textContent = i;
                        document.querySelector('.bagua-map').appendChild(piece);
                    }
                    
                    // ËÆæÁΩÆÂàùÂßã‰ΩçÁΩÆ
                    const positions = [
                        { top: '50%', left: '50%' }, // Áé©ÂÆ∂1 - ‰∏≠Â§Æ
                        { top: '20%', left: '50%' },  // Áé©ÂÆ∂2 - Á¶ª‰Ωç
                        { top: '50%', left: '20%' },  // Áé©ÂÆ∂3 - Èúá‰Ωç
                        { top: '80%', left: '50%' }   // Áé©ÂÆ∂4 - Âùé‰Ωç
                    ];
                    
                    piece.style.top = positions[i-1].top;
                    piece.style.left = positions[i-1].left;
                    piece.style.transform = 'translate(-50%, -50%)';
                }

                // ÂàõÂª∫AIÁé©ÂÆ∂Êï∞ÊçÆ
                this.aiPlayers = [];
                for (let i = 1; i <= 4; i++) {
                    this.aiPlayers.push({
                        id: i,
                        name: `Áé©ÂÆ∂${i}`,
                        position: i === 1 ? 'center' : [0, 6, 4][i-2],
                        health: 100,
                        energy: 50,
                        qi: 30,
                        balance: 0,
                        actions: 3,
                        cards: this.generateRandomCards(2)
                    });
                }
                this.updateAIDisplay();
            }

            runFourPlayerDemo() {
                if (!this.fourPlayerMode) return;

                const currentPlayerIndex = this.demoStep % 4;
                const currentPlayer = this.aiPlayers[currentPlayerIndex];
                
                this.addLogEntry('demo', `${currentPlayer.name}ÁöÑÂõûÂêàÂºÄÂßã`);
                this.highlightCurrentPlayer(currentPlayer.id);
                
                // Ê®°ÊãüÁé©ÂÆ∂Ë°åÂä®
                setTimeout(() => {
                    this.simulatePlayerAction(currentPlayer);
                }, 1000);

                setTimeout(() => {
                    this.demoStep++;
                    if (this.demoStep < 16) { // 4ËΩÆÊºîÁ§∫
                        this.runFourPlayerDemo();
                    } else {
                        this.addLogEntry('system', 'Âõõ‰∫∫ÊºîÁ§∫ÂÆåÊàê');
                        this.stopAutoDemo();
                    }
                }, 4000);
            }

            simulatePlayerAction(player) {
                const actions = ['move', 'playCard', 'meditate'];
                const action = actions[Math.floor(Math.random() * actions.length)];
                
                switch (action) {
                    case 'move':
                        const newPos = Math.floor(Math.random() * 8);
                        this.movePlayerToPosition(player.id, newPos);
                        this.addLogEntry('action', `${player.name}ÁßªÂä®Âà∞${this.baguaData[newPos].name}‰Ωç`);
                        break;
                    case 'playCard':
                        if (player.cards.length > 0) {
                            const card = player.cards[0];
                            this.addLogEntry('action', `${player.name}‰ΩøÁî®Âç°ÁâåÔºö${card.name}`);
                            this.applyCardEffect(player, card);
                        }
                        break;
                    case 'meditate':
                        player.qi += 10;
                        player.energy += 5;
                        this.addLogEntry('action', `${player.name}ËøõË°åÂÜ•ÊÉ≥ÔºåÊÅ¢Â§çÊ∞îÂÄºÂíåËÉΩÈáè`);
                        break;
                }
                
                this.updateAIDisplay();
            }

            movePlayerToPosition(playerId, position) {
                const piece = document.getElementById(`player${playerId}Piece`);
                const positionElement = document.querySelector(`[data-position="${position}"]`);
                
                if (piece && positionElement) {
                    const rect = positionElement.getBoundingClientRect();
                    const containerRect = document.querySelector('.bagua-map').getBoundingClientRect();
                    
                    const relativeTop = ((rect.top - containerRect.top + rect.height/2) / containerRect.height) * 100;
                    const relativeLeft = ((rect.left - containerRect.left + rect.width/2) / containerRect.width) * 100;
                    
                    piece.style.top = `${relativeTop}%`;
                    piece.style.left = `${relativeLeft}%`;
                    piece.style.transform = 'translate(-50%, -50%)';
                    
                    // Êõ¥Êñ∞Áé©ÂÆ∂Êï∞ÊçÆ
                    if (this.aiPlayers[playerId-1]) {
                        this.aiPlayers[playerId-1].position = position;
                    }
                }
            }

            highlightCurrentPlayer(playerId) {
                // ÁßªÈô§ÊâÄÊúâÈ´ò‰∫Æ
                document.querySelectorAll('.ai-player').forEach(el => el.classList.remove('active'));
                document.querySelectorAll('.player-piece').forEach(el => el.style.animation = 'playerPulse 2s infinite');
                
                // È´ò‰∫ÆÂΩìÂâçÁé©ÂÆ∂
                const aiPlayerElement = document.querySelector(`[data-player-id="${playerId}"]`);
                if (aiPlayerElement) {
                    aiPlayerElement.classList.add('active');
                }
                
                const piece = document.getElementById(`player${playerId}Piece`);
                if (piece) {
                    piece.style.animation = 'playerPulse 0.5s infinite';
                }
            }

            // ËæÖÂä©ÊñπÊ≥ï
            highlightPlayerStats() {
                document.querySelectorAll('.attribute').forEach(attr => {
                    attr.classList.add('highlight');
                    setTimeout(() => attr.classList.remove('highlight'), 2000);
                });
            }

            highlightCards() {
                document.querySelectorAll('.card').forEach(card => {
                    card.style.animation = 'pulse 1s infinite';
                    setTimeout(() => card.style.animation = '', 2000);
                });
            }

            highlightPosition(position) {
                const posElement = document.querySelector(`[data-position="${position}"]`);
                if (posElement) {
                    posElement.style.animation = 'pulse 1s infinite';
                    setTimeout(() => posElement.style.animation = '', 2000);
                }
            }

            updateStatsWithAnimation() {
                this.playerStats.qi += 20;
                this.playerStats.balance += 15;
                this.updateDisplay();
                this.highlightPlayerStats();
            }

            generateRandomCards(count) {
                const cards = [];
                for (let i = 0; i < count; i++) {
                    const randomCard = this.cardDatabase[Math.floor(Math.random() * this.cardDatabase.length)];
                    cards.push({...randomCard});
                }
                return cards;
            }

            applyCardEffect(player, card) {
                switch (card.type) {
                    case 'Â¢ûÁõä':
                        player.qi += 20;
                        break;
                    case 'Ê≤ªÁñó':
                        player.health += 15;
                        break;
                    case 'ÊîªÂáª':
                        player.energy += 10;
                        break;
                    case 'Âπ≥Ë°°':
                        player.balance = Math.max(-100, Math.min(100, player.balance - 20));
                        break;
                }
                player.energy -= card.cost;
            }

            updateAIDisplay() {
                const container = document.getElementById('aiPlayers');
                container.innerHTML = '';
                
                this.aiPlayers.forEach(player => {
                    const playerDiv = document.createElement('div');
                    playerDiv.className = 'ai-player';
                    playerDiv.setAttribute('data-player-id', player.id);
                    
                    const positionName = player.position === 'center' ? '‰∏≠Â§Æ' : this.baguaData[player.position]?.name || 'Êú™Áü•';
                    
                    playerDiv.innerHTML = `
                        <h4>${player.name}</h4>
                        <div class="ai-stats">
                            <div class="ai-stat">‰ΩçÁΩÆ: ${positionName}</div>
                            <div class="ai-stat">ÁîüÂëΩ: ${player.health}</div>
                            <div class="ai-stat">ËÉΩÈáè: ${player.energy}</div>
                            <div class="ai-stat">Ê∞îÂÄº: ${player.qi}</div>
                            <div class="ai-stat">Âπ≥Ë°°: ${player.balance}</div>
                            <div class="ai-stat">Ë°åÂä®: ${player.actions}</div>
                        </div>
                    `;
                    
                    container.appendChild(playerDiv);
                });
            }

            // AIÊ®°ÊãüÂäüËÉΩ
            startAISimulation() {
                if (this.aiMode) {
                    this.stopAISimulation();
                    return;
                }

                this.aiMode = true;
                document.getElementById('aiBtn').textContent = 'ÂÅúÊ≠¢AIÊ®°Êãü';
                this.addLogEntry('system', 'ÂºÄÂßãAIÊ®°ÊãüÊ®°Âºè');
                
                // ÂàõÂª∫AIÁé©ÂÆ∂
                this.createAIPlayer();
                this.runAITurn();
            }

            stopAISimulation() {
                this.aiMode = false;
                if (this.aiTimer) {
                    clearTimeout(this.aiTimer);
                    this.aiTimer = null;
                }
                document.getElementById('aiBtn').textContent = 'AIÊ®°Êãü';
                this.addLogEntry('system', 'AIÊ®°ÊãüÂ∑≤ÂÅúÊ≠¢');
            }

            createAIPlayer() {
                this.aiPlayer = {
                    position: 'center',
                    health: 100,
                    energy: 50,
                    qi: 30,
                    balance: 0,
                    actions: 3,
                    strategy: 'balanced', // balanced, aggressive, defensive
                    cards: this.generateRandomCards(3)
                };
            }

            runAITurn() {
                if (!this.aiMode) return;

                this.addLogEntry('ai', 'AIÊ≠£Âú®ÊÄùËÄÉ...');
                
                setTimeout(() => {
                    const action = this.calculateAIAction();
                    this.executeAIAction(action);
                    
                    this.aiTimer = setTimeout(() => {
                        this.runAITurn();
                    }, 2000);
                }, 1000);
            }

            calculateAIAction() {
                const actions = [];
                
                // ËØÑ‰º∞ÁßªÂä®
                if (this.aiPlayer.actions > 0) {
                    for (let i = 0; i < 8; i++) {
                        actions.push({
                            type: 'move',
                            target: i,
                            weight: this.calculateMoveWeight(i)
                        });
                    }
                }
                
                // ËØÑ‰º∞‰ΩøÁî®Âç°Áâå
                if (this.aiPlayer.cards.length > 0 && this.aiPlayer.energy >= this.aiPlayer.cards[0].cost) {
                    actions.push({
                        type: 'playCard',
                        card: this.aiPlayer.cards[0],
                        weight: this.calculateCardWeight(this.aiPlayer.cards[0])
                    });
                }
                
                // ËØÑ‰º∞ÂÜ•ÊÉ≥
                if (this.aiPlayer.qi < 50 || this.aiPlayer.energy < 30) {
                    actions.push({
                        type: 'meditate',
                        weight: this.calculateMeditateWeight()
                    });
                }
                
                // ÈÄâÊã©ÊúÄ‰Ω≥Ë°åÂä®
                if (actions.length === 0) {
                    return { type: 'endTurn' };
                }
                
                actions.sort((a, b) => b.weight - a.weight);
                return actions[0];
            }

            calculateMoveWeight(position) {
                const gua = this.baguaData[position];
                let weight = 50;
                
                // Ê†πÊçÆÂΩìÂâçÁä∂ÊÄÅË∞ÉÊï¥ÊùÉÈáç
                if (this.aiPlayer.balance < -30 && gua.element === 'ÁÅ´') {
                    weight += 30; // ÈúÄË¶ÅÈò≥Ê∞îÊó∂ÂÅèÂêëÁÅ´‰Ωç
                } else if (this.aiPlayer.balance > 30 && gua.element === 'Ê∞¥') {
                    weight += 30; // ÈúÄË¶ÅÈò¥Ê∞îÊó∂ÂÅèÂêëÊ∞¥‰Ωç
                }
                
                if (this.aiPlayer.qi < 40 && gua.element === 'Âúü') {
                    weight += 20; // Ê∞îÂÄº‰ΩéÊó∂ÂÅèÂêëÂúü‰ΩçÁ®≥ÂÆö
                }
                
                return weight;
            }

            calculateCardWeight(card) {
                let weight = 40;
                
                if (card.type === 'Ê≤ªÁñó' && this.aiPlayer.health < 70) {
                    weight += 40;
                } else if (card.type === 'Â¢ûÁõä' && this.aiPlayer.qi < 50) {
                    weight += 30;
                } else if (card.type === 'Âπ≥Ë°°' && Math.abs(this.aiPlayer.balance) > 50) {
                    weight += 35;
                }
                
                return weight;
            }

            calculateMeditateWeight() {
                let weight = 30;
                
                if (this.aiPlayer.qi < 30) weight += 25;
                if (this.aiPlayer.energy < 25) weight += 20;
                
                return weight;
            }

            executeAIAction(action) {
                switch (action.type) {
                    case 'move':
                        this.aiPlayer.position = action.target;
                        this.aiPlayer.actions--;
                        this.addLogEntry('ai', `AIÁßªÂä®Âà∞${this.baguaData[action.target].name}‰Ωç`);
                        this.applyGuaEffect(action.target);
                        break;
                        
                    case 'playCard':
                        this.aiPlayer.energy -= action.card.cost;
                        this.aiPlayer.cards.shift();
                        this.addLogEntry('ai', `AI‰ΩøÁî®Âç°ÁâåÔºö${action.card.name}`);
                        this.applyCardEffectToAI(action.card);
                        break;
                        
                    case 'meditate':
                        this.aiPlayer.qi += 15;
                        this.aiPlayer.energy += 10;
                        this.aiPlayer.actions--;
                        this.addLogEntry('ai', 'AIËøõË°åÂÜ•ÊÉ≥ÔºåÊÅ¢Â§çÊ∞îÂÄºÂíåËÉΩÈáè');
                        break;
                        
                    case 'endTurn':
                        this.aiPlayer.actions = 3;
                        this.addLogEntry('ai', 'AIÁªìÊùüÂõûÂêà');
                        break;
                }
                
                this.updateAIDisplaySingle();
            }

            applyGuaEffect(position) {
                const gua = this.baguaData[position];
                
                switch (gua.element) {
                    case 'ÁÅ´':
                        this.aiPlayer.balance += 20;
                        this.aiPlayer.energy += 5;
                        break;
                    case 'Ê∞¥':
                        this.aiPlayer.balance -= 20;
                        this.aiPlayer.qi += 10;
                        break;
                    case 'Âúü':
                        this.aiPlayer.qi += 15;
                        this.aiPlayer.health += 5;
                        break;
                    case 'Èáë':
                        this.aiPlayer.energy += 10;
                        break;
                    case 'Êú®':
                        this.aiPlayer.actions += 1;
                        break;
                }
                
                // ÈôêÂà∂Êï∞ÂÄºËåÉÂõ¥
                this.aiPlayer.balance = Math.max(-100, Math.min(100, this.aiPlayer.balance));
                this.aiPlayer.health = Math.min(100, this.aiPlayer.health);
                this.aiPlayer.qi = Math.min(100, this.aiPlayer.qi);
                this.aiPlayer.energy = Math.min(100, this.aiPlayer.energy);
            }

            applyCardEffectToAI(card) {
                switch (card.type) {
                    case 'Â¢ûÁõä':
                        this.aiPlayer.qi += 20;
                        break;
                    case 'Ê≤ªÁñó':
                        this.aiPlayer.health += 15;
                        break;
                    case 'ÊîªÂáª':
                        this.aiPlayer.energy += 10;
                        break;
                    case 'Âπ≥Ë°°':
                        this.aiPlayer.balance = Math.max(-100, Math.min(100, this.aiPlayer.balance - 20));
                        break;
                }
            }

            updateAIDisplaySingle() {
                // Êõ¥Êñ∞Âçï‰∏™AIÁé©ÂÆ∂ÊòæÁ§∫ÔºàÁî®‰∫éAIÊ®°ÊãüÊ®°ÂºèÔºâ
                const container = document.getElementById('aiPlayers');
                const positionName = this.aiPlayer.position === 'center' ? '‰∏≠Â§Æ' : this.baguaData[this.aiPlayer.position]?.name || 'Êú™Áü•';
                
                container.innerHTML = `
                    <div class="ai-player active">
                        <h4>AIÁé©ÂÆ∂</h4>
                        <div class="ai-stats">
                            <div class="ai-stat">‰ΩçÁΩÆ: ${positionName}</div>
                            <div class="ai-stat">ÁîüÂëΩ: ${this.aiPlayer.health}</div>
                            <div class="ai-stat">ËÉΩÈáè: ${this.aiPlayer.energy}</div>
                            <div class="ai-stat">Ê∞îÂÄº: ${this.aiPlayer.qi}</div>
                            <div class="ai-stat">Âπ≥Ë°°: ${this.aiPlayer.balance}</div>
                            <div class="ai-stat">Ë°åÂä®: ${this.aiPlayer.actions}</div>
                        </div>
                    </div>
                `;
            }

            // Ê∏∏ÊàèÂü∫Á°ÄÂäüËÉΩ
            moveToPosition(position) {
                if (this.playerStats.actions <= 0) {
                    this.addLogEntry('error', 'Ê≤°ÊúâË∂≥Â§üÁöÑË°åÂä®ÁÇπ');
                    this.showActionFeedback('error');
                    return;
                }

                // Ê∑ªÂä†ÁßªÂä®Âä®ÁîªÊïàÊûú
                this.showMoveAnimation(position);
                
                this.playerPosition = position;
                this.playerStats.actions--;
                
                const gua = this.baguaData[position];
                this.addLogEntry('player', `ÁßªÂä®Âà∞${gua.name}‰ΩçÔºà${gua.direction}Ôºâ`);
                this.addLogEntry('effect', gua.effect);
                
                // Â∫îÁî®ÂÖ´Âç¶ÊïàÊûú
                this.applyPositionEffect(position);
                this.updateDisplay();
                this.updatePlayerPiecePosition(position);
                
                // È´ò‰∫ÆÂΩìÂâç‰ΩçÁΩÆ
                this.highlightCurrentPosition();
                this.showActionFeedback('move');
            }

            moveToCenter() {
                if (this.playerStats.actions <= 0) {
                    this.addLogEntry('error', 'Ê≤°ÊúâË∂≥Â§üÁöÑË°åÂä®ÁÇπ');
                    this.showActionFeedback('error');
                    return;
                }

                this.showMoveAnimation('center');
                
                this.playerPosition = 'center';
                this.playerStats.actions--;
                this.addLogEntry('player', 'ÁßªÂä®Âà∞Â§™ÊûÅ‰∏≠ÂøÉ');
                this.addLogEntry('effect', 'Âú®Â§™ÊûÅ‰∏≠ÂøÉÂÜ•ÊÉ≥ÔºåÊÅ¢Â§çÈò¥Èò≥Âπ≥Ë°°');
                
                // Â§™ÊûÅ‰∏≠ÂøÉÊïàÊûú
                this.playerStats.balance = Math.max(-100, Math.min(100, this.playerStats.balance * 0.8));
                this.playerStats.qi += 10;
                
                this.updateDisplay();
                this.updatePlayerPiecePosition('center');
                this.highlightCurrentPosition();
                this.showActionFeedback('center');
            }

            updatePlayerPiecePosition(position) {
                const piece = document.getElementById('player1Piece');
                
                if (position === 'center') {
                    piece.style.top = '50%';
                    piece.style.left = '50%';
                    piece.style.transform = 'translate(-50%, -50%)';
                } else {
                    const positionElement = document.querySelector(`[data-position="${position}"]`);
                    if (positionElement) {
                        const rect = positionElement.getBoundingClientRect();
                        const containerRect = document.querySelector('.bagua-map').getBoundingClientRect();
                        
                        const relativeTop = ((rect.top - containerRect.top + rect.height/2) / containerRect.height) * 100;
                        const relativeLeft = ((rect.left - containerRect.left + rect.width/2) / containerRect.width) * 100;
                        
                        piece.style.top = `${relativeTop}%`;
                        piece.style.left = `${relativeLeft}%`;
                        piece.style.transform = 'translate(-50%, -50%)';
                    }
                }
            }

            applyPositionEffect(position) {
                const gua = this.baguaData[position];
                
                switch (gua.element) {
                    case 'ÁÅ´':
                        this.playerStats.balance += 25;
                        this.playerStats.energy += 10;
                        break;
                    case 'Ê∞¥':
                        this.playerStats.balance -= 25;
                        this.playerStats.qi += 15;
                        break;
                    case 'Âúü':
                        this.playerStats.qi += 20;
                        this.playerStats.health += 10;
                        break;
                    case 'Èáë':
                        this.playerStats.energy += 15;
                        this.playerStats.balance += 10;
                        break;
                    case 'Êú®':
                        this.playerStats.actions += 1;
                        this.playerStats.energy += 5;
                        break;
                }
                
                // ÈôêÂà∂Êï∞ÂÄºËåÉÂõ¥
                this.playerStats.balance = Math.max(-100, Math.min(100, this.playerStats.balance));
                this.playerStats.health = Math.min(100, this.playerStats.health);
                this.playerStats.qi = Math.min(100, this.playerStats.qi);
                this.playerStats.energy = Math.min(100, this.playerStats.energy);
            }

            selectCard(index) {
                this.selectedCard = index;
                document.querySelectorAll('.card').forEach((card, i) => {
                    card.classList.toggle('selected', i === index);
                });
                this.addLogEntry('player', `ÈÄâÊã©‰∫ÜÂç°ÁâåÔºö${this.cardDatabase[index].name}`);
            }

            playSelectedCard() {
                if (this.selectedCard === null) {
                    this.addLogEntry('error', 'ËØ∑ÂÖàÈÄâÊã©‰∏ÄÂº†Âç°Áâå');
                    this.showActionFeedback('error');
                    return;
                }

                const card = this.cardDatabase[this.selectedCard];
                if (this.playerStats.energy < card.cost) {
                    this.addLogEntry('error', 'ËÉΩÈáè‰∏çË∂≥');
                    this.showActionFeedback('error');
                    return;
                }

                this.playerStats.energy -= card.cost;
                this.addLogEntry('player', `‰ΩøÁî®Âç°ÁâåÔºö${card.name}`);
                this.addLogEntry('effect', card.effect);
                
                // Â∫îÁî®Âç°ÁâåÊïàÊûú
                this.applyCardEffectToPlayer(card);
                this.selectedCard = null;
                document.querySelectorAll('.card').forEach(card => card.classList.remove('selected'));
                this.updateDisplay();
                this.showActionFeedback('card');
            }

            applyCardEffectToPlayer(card) {
                // Âü∫Á°ÄÂç°ÁâåÊïàÊûú
                let baseEffect = this.getBaseCardEffect(card);
                
                // Ê£ÄÊü•‰ΩçÁΩÆÂçèÂêåÊïàÊûú
                let positionBonus = this.calculatePositionSynergy(card);
                
                // Â∫îÁî®ÊïàÊûú
                this.playerStats.qi += baseEffect.qi;
                this.playerStats.health += baseEffect.health;
                this.playerStats.energy += baseEffect.energy;
                this.playerStats.balance += baseEffect.balance;
                
                // Â∫îÁî®‰ΩçÁΩÆÂä†Êàê
                if (positionBonus.active) {
                    this.playerStats.qi += positionBonus.qi;
                    this.playerStats.health += positionBonus.health;
                    this.playerStats.energy += positionBonus.energy;
                    this.playerStats.balance += positionBonus.balance;
                    
                    this.addLogEntry('synergy', `${positionBonus.message}`);
                    this.showSynergyEffect(positionBonus.type);
                }
                
                // ÈôêÂà∂Êï∞ÂÄºËåÉÂõ¥
                this.playerStats.balance = Math.max(-100, Math.min(100, this.playerStats.balance));
                this.playerStats.health = Math.min(100, this.playerStats.health);
                this.playerStats.qi = Math.min(100, this.playerStats.qi);
                this.playerStats.energy = Math.min(100, this.playerStats.energy);
            }

            getBaseCardEffect(card) {
                const effects = {
                    qi: 0, health: 0, energy: 0, balance: 0
                };

                switch (card.type) {
                    case 'Â¢ûÁõä':
                        effects.qi = 20;
                        break;
                    case 'Ê≤ªÁñó':
                        effects.health = 15;
                        break;
                    case 'ÊîªÂáª':
                        effects.energy = 10;
                        break;
                    case 'ÊøÄÂèë':
                        effects.balance = 25;
                        effects.energy = 15;
                        break;
                    case 'Âπ≥Ë°°':
                        effects.balance = -20;
                        effects.qi = 10;
                        break;
                    case 'Èò≤Âæ°':
                        effects.health = 20;
                        effects.qi = 5;
                        break;
                    case 'ÊÅ¢Â§ç':
                        effects.energy = 20;
                        effects.health = 10;
                        break;
                }

                return effects;
            }

            calculatePositionSynergy(card) {
                const currentPosition = this.playerPosition;
                if (currentPosition === 'center') {
                    return { active: false };
                }

                const currentGua = this.baguaData[currentPosition];
                const cardElement = card.element;
                
                // Ê£ÄÊü•ÂÖÉÁ¥†ÂçèÂêå
                if (currentGua.element === cardElement) {
                    return {
                        active: true,
                        type: 'perfect',
                        qi: 15,
                        health: 10,
                        energy: 10,
                        balance: currentGua.element === 'ÁÅ´' || currentGua.element === 'Èáë' ? 15 : -15,
                        message: `ÂÆåÁæéÂçèÂêåÔºÅ${card.name}‰∏é${currentGua.name}Âç¶‰∫ßÁîüÂº∫ÁÉàÂÖ±È∏£ÔºÅ`
                    };
                }

                // Ê£ÄÊü•Áõ∏ÁîüÂÖ≥Á≥ª
                const elementCycle = {
                    'Êú®': 'ÁÅ´', 'ÁÅ´': 'Âúü', 'Âúü': 'Èáë', 'Èáë': 'Ê∞¥', 'Ê∞¥': 'Êú®'
                };
                
                if (elementCycle[cardElement] === currentGua.element) {
                    return {
                        active: true,
                        type: 'generate',
                        qi: 8,
                        health: 5,
                        energy: 5,
                        balance: 8,
                        message: `Áõ∏ÁîüÊïàÂ∫îÔºö${cardElement}Áîü${currentGua.element}ÔºåÊïàÊûúÂ¢ûÂº∫ÔºÅ`
                    };
                }

                if (elementCycle[currentGua.element] === cardElement) {
                    return {
                        active: true,
                        type: 'support',
                        qi: 5,
                        health: 8,
                        energy: 3,
                        balance: 5,
                        message: `Áõ∏Âä©ÊïàÂ∫îÔºö${currentGua.element}Âä©${cardElement}ÔºåÁ®≥Âõ∫Ê†πÂü∫ÔºÅ`
                    };
                }

                return { active: false };
            }

            showSynergyEffect(type) {
                const baguaMap = document.querySelector('.bagua-map');
                if (!baguaMap) return;

                baguaMap.classList.add(`synergy-${type}`);
                setTimeout(() => {
                    baguaMap.classList.remove(`synergy-${type}`);
                }, 2000);
            }

            endTurn() {
                this.playerStats.actions = 3;
                this.turnCounter++;
                this.addLogEntry('system', `Á¨¨${this.turnCounter}ÂõûÂêàÂºÄÂßã`);
                this.updateDisplay();
            }

            updateDisplay() {
                document.getElementById('playerPosition').textContent = 
                    this.playerPosition === 'center' ? '‰∏≠Â§Æ' : this.baguaData[this.playerPosition]?.name || 'Êú™Áü•';
                document.getElementById('playerHealth').textContent = this.playerStats.health;
                document.getElementById('playerEnergy').textContent = this.playerStats.energy;
                document.getElementById('playerQi').textContent = this.playerStats.qi;
                document.getElementById('playerActions').textContent = this.playerStats.actions;
                document.getElementById('turnCounter').textContent = this.turnCounter;
                
                // Êõ¥Êñ∞Èò¥Èò≥Âπ≥Ë°°ÊòæÁ§∫
                let balanceText = 'Âπ≥Ë°°';
                if (this.playerStats.balance > 30) {
                    balanceText = `Èò≥Áõõ(+${this.playerStats.balance})`;
                } else if (this.playerStats.balance < -30) {
                    balanceText = `Èò¥Áõõ(${this.playerStats.balance})`;
                } else if (this.playerStats.balance !== 0) {
                    balanceText = `${this.playerStats.balance > 0 ? 'ÂÅèÈò≥' : 'ÂÅèÈò¥'}(${this.playerStats.balance})`;
                }
                document.getElementById('playerBalance').textContent = balanceText;
                
                // Êõ¥Êñ∞Âç°ÁâåÊòæÁ§∫
                this.updateCardDisplay();
            }

            updateCardDisplay() {
                const playerCardsContainer = document.getElementById('playerCards');
                if (!playerCardsContainer) return;
                
                // Ê∏ÖÁ©∫Áé∞ÊúâÂç°Áâå
                playerCardsContainer.innerHTML = '';
                
                // ÊòæÁ§∫Ââç3Âº†Âç°Áâå‰Ωú‰∏∫ÊâãÁâå
                const handCards = this.cardDatabase.slice(0, 3);
                
                handCards.forEach((card, index) => {
                    const cardElement = document.createElement('div');
                    const isPlayable = this.playerStats.energy >= card.cost;
                    const synergyInfo = this.getCardSynergyInfo(card);
                    
                    cardElement.className = `card ${isPlayable ? 'playable' : ''} ${synergyInfo.class}`;
                    cardElement.setAttribute('data-element', card.element);
                    cardElement.onclick = () => this.selectCard(index);
                    cardElement.title = `${card.description}${synergyInfo.tooltip}`;
                    
                    // Ê†πÊçÆÁ®ÄÊúâÂ∫¶ËÆæÁΩÆËæπÊ°ÜÈ¢úËâ≤
                    let rarityClass = '';
                    switch(card.rarity) {
                        case 'legendary': rarityClass = 'border-legendary'; break;
                        case 'epic': rarityClass = 'border-epic'; break;
                        case 'rare': rarityClass = 'border-rare'; break;
                        default: rarityClass = 'border-common';
                    }
                    cardElement.classList.add(rarityClass);
                    
                    cardElement.innerHTML = `
                        <div class="card-cost">${card.cost}</div>
                        <div class="card-element">${card.element}</div>
                        <div class="card-name">${card.name}</div>
                        <div class="card-icon">${card.icon}</div>
                        <div class="card-effect">${card.effect}</div>
                        ${synergyInfo.indicator}
                    `;
                    
                    playerCardsContainer.appendChild(cardElement);
                });
            }

            getCardSynergyInfo(card) {
                const synergy = this.calculatePositionSynergy(card);
                
                if (!synergy.active) {
                    return {
                        class: '',
                        tooltip: '',
                        indicator: ''
                    };
                }

                const synergyTypes = {
                    'perfect': { name: 'ÂÆåÁæéÂçèÂêå', color: '#FFD700', icon: '‚ú®' },
                    'generate': { name: 'Áõ∏ÁîüÊïàÂ∫î', color: '#90EE90', icon: 'üîÑ' },
                    'support': { name: 'Áõ∏Âä©ÊïàÂ∫î', color: '#87CEEB', icon: 'ü§ù' }
                };

                const synergyType = synergyTypes[synergy.type];
                
                return {
                    class: `synergy-${synergy.type}`,
                    tooltip: `\n\n${synergyType.icon} ${synergyType.name}Ôºö${synergy.message}`,
                    indicator: `<div class="synergy-indicator" style="color: ${synergyType.color}">${synergyType.icon}</div>`
                };
            }

            showMoveAnimation(targetPosition) {
                const playerPiece = document.getElementById('player1Piece');
                if (!playerPiece) return;

                // Ê∑ªÂä†ÁßªÂä®Âä®ÁîªÁ±ª
                playerPiece.classList.add('moving');
                
                // ÂàõÂª∫ÁßªÂä®ËΩ®ËøπÊïàÊûú
                const trail = document.createElement('div');
                trail.className = 'move-trail';
                trail.style.left = playerPiece.style.left;
                trail.style.top = playerPiece.style.top;
                document.querySelector('.bagua-map').appendChild(trail);
                
                setTimeout(() => {
                    playerPiece.classList.remove('moving');
                    if (trail.parentNode) {
                        trail.parentNode.removeChild(trail);
                    }
                }, 800);
            }

            highlightCurrentPosition() {
                // Ê∏ÖÈô§‰πãÂâçÁöÑÈ´ò‰∫Æ
                document.querySelectorAll('.bagua-position, .center-taiji').forEach(el => {
                    el.classList.remove('current-position');
                });

                // È´ò‰∫ÆÂΩìÂâç‰ΩçÁΩÆ
                if (this.playerPosition === 'center') {
                    document.querySelector('.center-taiji').classList.add('current-position');
                } else {
                    const currentPos = document.querySelector(`[data-position="${this.playerPosition}"]`);
                    if (currentPos) {
                        currentPos.classList.add('current-position');
                    }
                }
            }

            showActionFeedback(type) {
                const feedbackTypes = {
                    'error': { color: '#ff4444', icon: '‚ùå', message: 'Ë°åÂä®Â§±Ë¥•' },
                    'move': { color: '#4CAF50', icon: 'üö∂', message: 'ÁßªÂä®ÊàêÂäü' },
                    'center': { color: '#FFD700', icon: 'üßò', message: 'ËøõÂÖ•ÂÜ•ÊÉ≥' },
                    'card': { color: '#2196F3', icon: 'üé¥', message: 'Âç°Áâå‰ΩøÁî®' }
                };

                const feedback = feedbackTypes[type];
                if (!feedback) return;

                // ÂàõÂª∫ÂèçÈ¶àÂÖÉÁ¥†
                const feedbackEl = document.createElement('div');
                feedbackEl.className = 'action-feedback';
                feedbackEl.style.color = feedback.color;
                feedbackEl.innerHTML = `${feedback.icon} ${feedback.message}`;
                
                document.body.appendChild(feedbackEl);
                
                setTimeout(() => {
                    if (feedbackEl.parentNode) {
                        feedbackEl.parentNode.removeChild(feedbackEl);
                    }
                }, 2000);
            }

            addLogEntry(type, message) {
                const logContainer = document.getElementById('gameLog');
                const entry = document.createElement('div');
                entry.className = `log-entry ${type}`;
                entry.textContent = `[${new Date().toLocaleTimeString()}] ${message}`;
                
                logContainer.appendChild(entry);
                logContainer.scrollTop = logContainer.scrollHeight;
                
                // ÈôêÂà∂Êó•ÂøóÊù°ÁõÆÊï∞Èáè
                while (logContainer.children.length > 50) {
                    logContainer.removeChild(logContainer.firstChild);
                }
            }
        }

        // ÂàõÂª∫Ê∏∏ÊàèÂÆû‰æã
        let game = new Game();

        // ÂÖ®Â±ÄÂáΩÊï∞
        function moveToPosition(position) {
            game.moveToPosition(position);
        }

        function moveToCenter() {
            game.moveToCenter();
        }

        function selectCard(index) {
            game.selectCard(index);
        }

        function playCard() {
            game.playSelectedCard();
        }

        function endTurn() {
            game.endTurn();
        }

        function clearLog() {
            const logContainer = document.getElementById('gameLog');
            logContainer.innerHTML = '<div class="log-entry system">Êó•ÂøóÂ∑≤Ê∏ÖÁ©∫</div>';
        }
    </script>
</body>
</html>